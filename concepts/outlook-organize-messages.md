# <a name="organize-outlook-messages"></a><span data-ttu-id="6122d-101">Outlook メッセージを整理する</span><span class="sxs-lookup"><span data-stu-id="6122d-101">Organize Outlook messages</span></span>

<span data-ttu-id="6122d-102">Outlook を利用することによりユーザーは、自分の好みの方法でメッセージを整理できます。同じ受信トレイ フォルダーに全メッセージを入れたままにしたり、受信トレイの下に各自の必要に合うようなフォルダーのツリー構造を作成してその中にメッセージを分類保存したりできます。</span><span class="sxs-lookup"><span data-stu-id="6122d-102">Outlook lets customers organize their messages the way they like it, be it leaving all messages in the same Inbox folder, or organizing messages in a tree-like folder structure under the Inbox to fit their specific needs.</span></span> <span data-ttu-id="6122d-103">ユーザーのメールボックス全体または特定のフォルダー内のメッセージに対して[フィルター処理、検索、またはソート](query_parameters.md)を便利に実行することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-103">You can conveniently [filter, search, or sort](query_parameters.md) messages in the user's entire mailbox or in specific folders.</span></span>

## <a name="accessing-mail-folders"></a><span data-ttu-id="6122d-104">メール フォルダーへのアクセス</span><span class="sxs-lookup"><span data-stu-id="6122d-104">Accessing mail folders</span></span>

<span data-ttu-id="6122d-105">プログラム的には、メッセージ フォルダーは [mailFolder](../api-reference/v1.0/resources/mailfolder.md) リソースによって表されており、受信トレイはフォルダー構造のルートにあるフォルダーの 1 つに含まれています。</span><span class="sxs-lookup"><span data-stu-id="6122d-105">Programmatically, message folders are represented by the [mailFolder](../api-reference/v1.0/resources/mailfolder.md) resource, and the Inbox is one of the folders at the root of the folder structure.</span></span>

<span data-ttu-id="6122d-106">各 **mailFolder** は、そのフォルダー ID によって識別され、書き込み可能な **displayName** プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="6122d-106">Each **mailFolder** is identified by its folder ID, and has a writable **displayName** property.</span></span> <span data-ttu-id="6122d-107">既定では、それ以外にいくつかのフォルダーが、Outlook によりユーザーのために作成されます。</span><span class="sxs-lookup"><span data-stu-id="6122d-107">Outlook creates a few other folders for customers by default.</span></span> <span data-ttu-id="6122d-108">それらの既定フォルダーは、フォルダー ID により参照するか、または既知の名前によって参照できます。</span><span class="sxs-lookup"><span data-stu-id="6122d-108">You can reference these default folders by their folder IDs, or by their well-known names.</span></span> <span data-ttu-id="6122d-109">使用可能な既知のフォルダー名の一覧については、「[mailFolder リソースの種類](../api-reference/v1.0/resources/mailfolder.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6122d-109">For a list of available well-known folder names, see [mailFolder resource type](../api-reference/v1.0/resources/mailfolder.md).</span></span>

<span data-ttu-id="6122d-110">既定以外のカスタム フォルダーの場合、そのフォルダー パスがわかっている場合は、まず `/users/{id}/mailfolders` ショートカットを使用してルート レベルを取得したり最上位レベルのすべてのフォルダーを取得したりして、フォルダーにアクセスできます:</span><span class="sxs-lookup"><span data-stu-id="6122d-110">For a custom, non-default folder, if you know its folder path, you can access the folder by first using the `/users/{id}/mailfolders` shortcut to get to the root level and get all the top level folders:</span></span>

```http
GET https://graph.microsoft.com/v1.0/users/{id}/mailFolders
```

<span data-ttu-id="6122d-111">その後、フォルダー ツリーの各レベルに移動する際に、該当するフォルダー ID (`{folder_id}`) を指定します:</span><span class="sxs-lookup"><span data-stu-id="6122d-111">Then, specify the appropriate folder ID (`{folder_id}`) as you navigate each level of the folder tree:</span></span>

```http
GET https://graph.microsoft.com/v1.0/users/{id}/mailFolders/{folder_id}/childfolders
```

<span data-ttu-id="6122d-112">最終的にツリー内のカスタム フォルダーに達するまで繰り返します。</span><span class="sxs-lookup"><span data-stu-id="6122d-112">Repeat until you finally get to the custom folder in the tree.</span></span>

## <a name="creating-and-organizing-the-folder-tree"></a><span data-ttu-id="6122d-113">フォルダー ツリーの作成と整理</span><span class="sxs-lookup"><span data-stu-id="6122d-113">Creating and organizing the folder tree</span></span>

<span data-ttu-id="6122d-114">[受信トレイの下にメール フォルダーを作成](../api-reference/v1.0/api/user_post_mailfolders.md)したり、[他のフォルダーの子フォルダーとして](../api-reference/v1.0/api/mailfolder_post_childfolders.md)作成したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-114">You can [create mail folders under the Inbox](../api-reference/v1.0/api/user_post_mailfolders.md), or as [child folders of other folders](../api-reference/v1.0/api/mailfolder_post_childfolders.md).</span></span> <span data-ttu-id="6122d-115">フォルダーとその内容を作成、[コピー](../api-reference/v1.0/api/mailfolder_copy.md)、または[移動](../api-reference/v1.0/api/mailfolder_move.md)する際、Outlook は、関係するフォルダーの読み取り専用の **parentFolderId** および **childFolderCount** のプロパティを更新します。</span><span class="sxs-lookup"><span data-stu-id="6122d-115">When you create, [copy](../api-reference/v1.0/api/mailfolder_copy.md), or [move](../api-reference/v1.0/api/mailfolder_move.md) a folder and its contents, Outlook updates the read-only **parentFolderId** and **childFolderCount** properties of the involved folders.</span></span> <span data-ttu-id="6122d-116">フォルダーの内容が別のフォルダーにコピーされたり移動したりする際には、既定ではその内容である個々のエントリ ID も変化します。</span><span class="sxs-lookup"><span data-stu-id="6122d-116">When the contents of a folder are copied or moved to another folder, by default, the individual entry IDs of the contents also change.</span></span>

<span data-ttu-id="6122d-117">内容のレベルで、**totalItemCount** および **unreadItemCount** は、メール フォルダー内のアイテム数と未読アイテム数をそれぞれ示します。</span><span class="sxs-lookup"><span data-stu-id="6122d-117">At the contents level, **totalItemCount** and **unreadItemCount** respectively tell you the number of items and number of unread items in a mail folder.</span></span>
<span data-ttu-id="6122d-118">子フォルダーのレベルでは、受信トレイまたは他のフォルダーの下の[子フォルダーのリスト](../api-reference/v1.0/api/user_list_mailfolders.md)を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-118">At the child folders level, you can [list the child folders](../api-reference/v1.0/api/user_list_mailfolders.md) under the Inbox or any other folder.</span></span>
<span data-ttu-id="6122d-119">**childFolderCount** プロパティは、直下の子フォルダーの数を表します。</span><span class="sxs-lookup"><span data-stu-id="6122d-119">The **childFolderCount** property represents the number of immediate child folders.</span></span>

<span data-ttu-id="6122d-120">Outlook メール フォルダーには、メッセージと共に、イベントや連絡先などのメッセージ以外のアイテムも含めることができることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="6122d-120">Be aware that Outlook mail folders can contain messages and non-message items such as events and contacts.</span></span> <span data-ttu-id="6122d-121">一般に Outlook フォルダーでは、異なるアイテムが混在可能です。</span><span class="sxs-lookup"><span data-stu-id="6122d-121">In general, Outlook folders can contain heterogeneous items.</span></span>

## <a name="using-rules-to-automate-copying-or-moving-messages"></a><span data-ttu-id="6122d-122">メッセージのコピーまたは移動を自動化するためのルールの使用</span><span class="sxs-lookup"><span data-stu-id="6122d-122">Using rules to automate copying or moving messages</span></span>

<span data-ttu-id="6122d-123">Outlook を使用することによりユーザーは、事前に決められた条件が満たされた時点で、受信メッセージに対して特定のアクションを自動化するためのルールを設定できます。</span><span class="sxs-lookup"><span data-stu-id="6122d-123">Outlook lets customers set up rules to automate specific actions on incoming messages when some pre-determined conditions are met.</span></span> <span data-ttu-id="6122d-124">特定の条件が満たされた場合に、メッセージを特定のフォルダーにコピーまたは移動するには、[messageRule](../api-reference/v1.0/resources/messagerule.md) として受信トレイの[ルールを作成](../api-reference/v1.0/api/mailfolder_post_messagerules.md)することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-124">You can [create a rule](../api-reference/v1.0/api/mailfolder_post_messagerules.md) for the Inbox as a [messageRule](../api-reference/v1.0/resources/messagerule.md) to copy or move a message to a specific folder upon certain conditions.</span></span>
<span data-ttu-id="6122d-125">条件は、[messageRulePredicates](../api-reference/v1.0/resources/messagerulepredicates.md) です。</span><span class="sxs-lookup"><span data-stu-id="6122d-125">Conditions are [messageRulePredicates](../api-reference/v1.0/resources/messagerulepredicates.md).</span></span> <span data-ttu-id="6122d-126">それには、特定のテキストが含まれるメッセージの件名または本文、特定のメール アドレスから送信されたメッセージ、重要マークが付けられたメッセージなどがあります。</span><span class="sxs-lookup"><span data-stu-id="6122d-126">They can include the message subject or body containing certain text,the message sent from certain email addresses, or the message marked important, and so on.</span></span>

## <a name="directing-only-the-messages-you-care-for-to-the-focused-inbox"></a><span data-ttu-id="6122d-127">気になるメッセージだけを優先受信トレイに入れる</span><span class="sxs-lookup"><span data-stu-id="6122d-127">Directing only the messages you care for to the Focused Inbox</span></span>

<span data-ttu-id="6122d-128">優先受信トレイを使用すると、ユーザーは、**[優先]** タブで指定する送信元からの受信メッセージのみを表示し、**[その他]** タブで指定するものを残りのメッセージとするように Outlook に指示することができます。最初、Outlook の分類システムでは、既定の方法で受信トレイのメッセージが整理されます。</span><span class="sxs-lookup"><span data-stu-id="6122d-128">Focused Inbox lets customers train Outlook to show only the incoming messages from senders you care for in the **Focused** tab, and the rest in the **Other** tab. Initially, Outlook's classification system organizes Inbox messages in a default way.</span></span> <span data-ttu-id="6122d-129">時間が経過するにつれて、ユーザー インターフェイスまたはプログラムを介して、システムを修正し、学習させることができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-129">Over time, you can correct and train the system through the user interface or programmatically.</span></span> <span data-ttu-id="6122d-130">優先受信トレイを使用すればするほど、どの受信メッセージを **[優先]** タブに表示することが望ましいかに関する分類システムの推論が向上していきます。</span><span class="sxs-lookup"><span data-stu-id="6122d-130">The more you use the Focused Inbox, the better the classification system can infer which incoming message you want to see in the **Focused** tab.</span></span>

<span data-ttu-id="6122d-131">プログラムにより、[メッセージ](../api-reference/v1.0/resources/message.md)の **inferenceClassification** プロパティを更新して、メッセージを **[優先]** タブに入れるのか、それとも **[その他]** タブに入れるのかを指示できます。これは、特定のメッセージのための 1 回限りの指定です。</span><span class="sxs-lookup"><span data-stu-id="6122d-131">Programmatically, you can update the **inferenceClassification** property of a [message](../api-reference/v1.0/resources/message.md) to indicate whether you want to see the message in the **Focused** or **Other** tab. This is a one-off designation for a specific message.</span></span> <span data-ttu-id="6122d-132">一方、特定の送信元からのメッセージが常に **[優先]** タブまたは **[その他]** タブに表示されるようにするには、Outlook 用の[命令を設定](../api-reference/v1.0/api/inferenceclassification_post_overrides.md)することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-132">If, on the other hand, you want to see messages from a specific sender always in the **Focused** tab or **Other** tab, you can [set an instruction](../api-reference/v1.0/api/inferenceclassification_post_overrides.md) for Outlook.</span></span> <span data-ttu-id="6122d-133">各命令は、送信元の名前、およびその送信元からのメッセージの保存先を常に `focused` または `other` として指定する [inferenceClassificationOverride](../api-reference/v1.0/resources/inferenceclassificationoverride.md) インスタンスです。</span><span class="sxs-lookup"><span data-stu-id="6122d-133">Each instruction is an [inferenceClassificationOverride](../api-reference/v1.0/resources/inferenceclassificationoverride.md) instance specifying the sender's name and your designation for messages from that sender to be always `focused` or `other`.</span></span> <span data-ttu-id="6122d-134">ユーザーの優先受信トレイのための各ユーザーの命令は、[user](../api-reference/v1.0/resources/user.md) オブジェクトの [inferenceClassificationOverride](../api-reference/v1.0/resources/inferenceclassificationoverride.md) インスタンスのコレクションとして保存されます。</span><span class="sxs-lookup"><span data-stu-id="6122d-134">Each user's instructions for the user's Focused Inbox are stored as a collection of [inferenceClassificationOverride](../api-reference/v1.0/resources/inferenceclassificationoverride.md) instances on the [user](../api-reference/v1.0/resources/user.md) object.</span></span>

## <a name="keeping-messages-and-mail-folders-up-to-date-in-apps"></a><span data-ttu-id="6122d-135">アプリの中でメッセージとメール フォルダーを最新の状態に保つ</span><span class="sxs-lookup"><span data-stu-id="6122d-135">Keeping messages and mail folders up to date in apps</span></span>

<span data-ttu-id="6122d-136">しばしばアプリでは、アプリのローカル ストアの中でユーザーのメール データを同期し、最新の状態に保つことが必要です。</span><span class="sxs-lookup"><span data-stu-id="6122d-136">Apps often have to synchronize and keep a user's mail data up-to-date in the app local store.</span></span> <span data-ttu-id="6122d-137">Microsoft Graph を利用すれば、変更通知をサブスクライブでき、データが変化した場合に通知を受け取り、変更発生後なるべく早い時点で実際の変更内容についてクエリを実行することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-137">Microsoft Graph lets you subscribe to change notifications to get notified when data changes, and query for actual changes as soon as they happen.</span></span>

<span data-ttu-id="6122d-138">通知は [webhooks](../api-reference/v1.0/resources/webhooks.md) により非同期に配信されるため、頻繁にポーリングするオーバーヘッドを回避できます。</span><span class="sxs-lookup"><span data-stu-id="6122d-138">Notifications are delivered via [webhooks](../api-reference/v1.0/resources/webhooks.md) asynchronously when the changes happen, saving apps the overhead to poll frequently.</span></span> <span data-ttu-id="6122d-139">ユーザーのメール データに対する追加、更新、または削除に関する[変更通知をサブスクライブ](../api-reference/v1.0/api/subscription_post_subscriptions.md)することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-139">You can [subscribe to change notifications](../api-reference/v1.0/api/subscription_post_subscriptions.md) about additions, updates, or deletions to a user's mail data.</span></span> <span data-ttu-id="6122d-140">たとえば、特定のフォルダー (`/me/mailFolders('{folderId'}')`) のメッセージ、またはルート レベル (`/me/messages`) のメッセージのサブスクリプションを作成できます。</span><span class="sxs-lookup"><span data-stu-id="6122d-140">For example, you can create a subscription to messages in a specific folder (i.e., `/me/mailFolders('{folderId'}')`), or at the root level (i.e., `/me/messages`).</span></span> <span data-ttu-id="6122d-141">サブスクリプションでは、**notificationUrl** を指定します。これは、要求された種類の変更が発生した場合に、Microsoft Graph からアプリに通知される通知先となるものです。</span><span class="sxs-lookup"><span data-stu-id="6122d-141">The subscription specifies a **notificationUrl** where Microsoft Graph notifies the app when the requested types of changes happen.</span></span>

<span data-ttu-id="6122d-142">ユーザーのメールボックスの初期同期を実行するには、まず [メール フォルダーの差分クエリをルート レベルで実行する](../api-reference/v1.0/api/mailfolder_delta.md)ことにより、すべてのメール フォルダーを同期し、次いで[各フォルダー内のメッセージについての差分クエリ](../api-reference/v1.0/api/message_delta.md)を実行して、個々のメッセージを同期します。</span><span class="sxs-lookup"><span data-stu-id="6122d-142">To initially synchronize a user's mailbox, first do [delta query for mail folders starting at the root level](../api-reference/v1.0/api/mailfolder_delta.md) to synchronize all mail folders, followed by [delta query for messages in each folder](../api-reference/v1.0/api/message_delta.md) to synchronize individual messages.</span></span>

<span data-ttu-id="6122d-143">通知ごとにリソース全体を読むことなく、変更のあったエンティティを正確に検出するには、[差分クエリ](delta_query_overview.md)を使用して、自分にとって気になる変更を追跡し、それらの変更内容によりローカル ストアを同期することができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-143">To find the exact entities that have been changed without reading the entire resource with every notification, you can use [delta query](delta_query_overview.md) to track those changes that matter to you, and synchronize your local store with those changes.</span></span> <span data-ttu-id="6122d-144">[特定のフォルダー内のメッセージへの変更内容を追跡する](delta_query_messages.md)ことができます。</span><span class="sxs-lookup"><span data-stu-id="6122d-144">You can [track changes to messages in a specific folder](delta_query_messages.md).</span></span> <span data-ttu-id="6122d-145">また、ルート レベル (`/me/mailfolders`) にあるメール フォルダーに対する変更内容を追跡することもできます。</span><span class="sxs-lookup"><span data-stu-id="6122d-145">You can also track changes to mail folders at the root level (i.e., `/me/mailfolders`).</span></span>

## <a name="next-steps"></a><span data-ttu-id="6122d-146">次の手順</span><span class="sxs-lookup"><span data-stu-id="6122d-146">Next steps</span></span>

<span data-ttu-id="6122d-147">詳細情報:</span><span class="sxs-lookup"><span data-stu-id="6122d-147">Find out more about:</span></span>

- [<span data-ttu-id="6122d-148">Outlook メールと統合する理由</span><span class="sxs-lookup"><span data-stu-id="6122d-148">Why integrate with Outlook mail</span></span>](outlook-mail-concept-overview.md)
- <span data-ttu-id="6122d-149">Microsoft Graph v1.0 の[メール API](../api-reference/v1.0/resources/mail_api_overview.md) とその[用途](../api-reference/v1.0/resources/mail_api_overview.md#common-use-cases)</span><span class="sxs-lookup"><span data-stu-id="6122d-149">[Using the mail API](../api-reference/v1.0/resources/mail_api_overview.md) and its [use cases](../api-reference/v1.0/resources/mail_api_overview.md#common-use-cases) in Microsoft Graph v1.0.</span></span>
